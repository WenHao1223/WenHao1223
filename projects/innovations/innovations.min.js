const db=firebase.firestore(),storageRef=firebase.storage().ref().child("projects/innovations");param=new URLSearchParams(window.location.search),paramID=param.get("id"),paramID?($("#b_back").removeClass("d-none"),db.collection("public/projects/innovations").doc(paramID).get().then((docSpecific=>{if(docSpecific.exists){docSpecificData=docSpecific.data(),$(".navbar_section").html($(".navbar_section").html()+`<div class="card"><img src="" id="${paramID}" alt="${paramID}" class="card-img-top"><div class="card-body"><h3 class="card-title">${docSpecificData.name}<span class="card-subheader">(${docSpecificData.createdYear})</span></h3><p class="card-text">${docSpecificData.des}</p><a class="card-link" data-bs-toggle="collapse" href="#readMore" role="button" aria-expanded="false" aria-controls="collapseExample"><i>Read More</i></a><div class="collapse mt-3" id="readMore"><div class="card card-body text-bg-dark">${docSpecificData.longEssay}</div></div><div class="row mt-3" style="width: calc(100vw - var(--padding) * 2);"><div class="col col-md-12"><ul class="list-group list-group-horizontal mb-3 horizontal_scrollbar"></ul><ul class="list-group list-group-horizontal mb-3 horizontal_scrollbar"></ul></div><div class="col col-md-12"></div></div></div></div>`),storageRef.child(paramID+".png").getDownloadURL().then((a=>{$(`img#${paramID}`).attr("src",a)})).catch((a=>{console.error("No such file - projects/innovations with ID of",paramID,": ",a)}));const gallery={first:"images",last:"attachments"};for(let i=0;i<Object.keys(gallery).length;i++)for(let j=0;j<(null!=docSpecificData[gallery[Object.keys(gallery)[i]]]?docSpecificData[gallery[Object.keys(gallery)[i]]].length:0);j++)eval(`$(".list-group").${Object.keys(gallery)[i]}()`).html(eval(`$(".list-group").${Object.keys(gallery)[i]}()`).html()+`<li class="list-group-item"><iframe src="https://drive.google.com/file/d/${docSpecificData[gallery[Object.keys(gallery)[i]]][j]}/preview" frameborder="0" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"></iframe></li>`)}else console.error("No such file - projects/innovations with ID of",paramID),$(".navbar_section").html("File not found.")})).catch((a=>{console.error("Error getting collection - innovations:",a)})),$("#readMore").on("show.bs.collapse",(function(){$("#readMore").prev().children().text("Show Less")})),$("#readMore").on("hide.bs.collapse",(function(){$("#readMore").prev().children().text("Read More")}))):($("#b_back").addClass("d-none"),db.collection("public/projects/innovations").orderBy("createdYear","desc").get().then((async a=>{let i=1;a.forEach((a=>{innovationData=a.data(),"horizontal"==innovationData.divStyle?$(".navbar_section").html($(".navbar_section").html()+`<div class="card vertical"><div class="row"><div class="col-sm-12 col-md-12 col-lg-4"><img src="" id="${a.id}" alt="${innovationData.name}" class="img-fluid"></div><div class="col-sm-12 col-md-12 col-lg-7"><div class="card-body"><h3 class="card-title">${innovationData.name}<span class="card-subheader">(${innovationData.createdYear})</span></h3><p class="card-text">${innovationData.des}</p><a href="?id=${a.id}" class="card-link"><i>Read More</i></a></div></div></div></div>`):"fullScreen"==innovationData.divStyle?$(".navbar_section").html($(".navbar_section").html()+`<div class="card"><img src="" id="${a.id}" alt="${innovationData.name}" class="card-img-top"><div class="card-body"><h3 class="card-title">${innovationData.name}<span class="card-subheader">(${innovationData.createdYear})</span></h3><p class="card-text">${innovationData.des}</p><a href="?id=${a.id}" class="card-link"><i>Read More</i></a></div></div>`):"vertical"==innovationData.divStyle&&(i%2?$(".navbar_section").html($(".navbar_section").html()+`<div class="row"><div class="col-xl-6 xl_index_${i}"><div class="card"><img src="" id="${a.id}" alt="${innovationData.name}" class="card-img-top"><div class="card-body"> <h3 class="card-title">${innovationData.name}<span class="card-subheader">(${innovationData.createdYear})</span></h3><p class="card-text">${innovationData.des}</p><a href="?id=${a.id}" class="card-link"><i>Read More</i></a></div></div></div><div class="col-xl-6 xl_index_${++i}"></div>`):($(`.xl_index_${i}`).html(`<div class="card"><img src="" id="${a.id}" alt="${innovationData.name}" class="card-img-top"><div class="card-body"> <h3 class="card-title">${innovationData.name}<span class="card-subheader">(${innovationData.createdYear})</span></h3><p class="card-text">${innovationData.des}</p><a href="?id=${a.id}" class="card-link"><i>Read More</i></a></div></div></div>`),i++)),storageRef.child(a.id+".png").getDownloadURL().then((i=>{$(`img#${a.id}`).attr("src",i)})).catch((a=>{console.error("No such file - projects/innovations: ",a)}))}))})).catch((a=>{console.error("Error getting list of documents inside innovations:",a)})));